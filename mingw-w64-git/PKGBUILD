_realname=git
pkgbase=mingw-w64-${_realname}
pkgname=("${MINGW_PACKAGE_PREFIX}-${realname}")
pkgver=2.30.0
pkgrel=1
pkgdesc="The fast distributed version control system"
arch=('i686' 'x86_64')
url="https://git-scm.com/"
license=('GPL2')
groups=('VCS')
depends=(
         "${MINGW_PACKAGE_PREFIX}-pcre2"
         )
makedepends=(
	"${MINGW_PACKAGE_PREFIX}-asciidoc" 'docbook-xml' 'docbook-xsl' 'xmlto'
	"${MINGW_PACKAGE_PREFIX}-gcc" "${MINGW_PACKAGE_PREFIX}-curl"
)
#install=git.install

source=("${_realname}-${pkgver}.tar.gz"::https://github.com/git/git/archive/v${pkgver}.tar.gz)
sha256sums=('8db4edd1a0a74ebf4b78aed3f9e25c8f2a7db3c00b1aaee94d1e9834fae24e61')



prepare() {
  cd "${srcdir}/${_realname}-${pkgver}"

  local _arch="amd64"
  sed -e "s|@ARCH@|${_arch}|g" -i compat/win32/git.manifest
}

build() {
  export PYTHON_PATH='/usr/bin/python'
  cd "${srcdir}/${_realname}-${pkgver}"
  make prefix=${MINGW_PREFIX}/usr profile
  make prefix=${MINGW_PREFIX}/usr PROFILE=BUILD man all
}

package() {
  cd "${srcdir}/${_realname}-${pkgver}"
  make DESTDIR="${pkgdir}" install
}

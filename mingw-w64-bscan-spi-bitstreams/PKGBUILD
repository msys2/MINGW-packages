# Contributor: Liu Pak Hin <wl@m-labs.hk>

_realname=bscan-spi-bitstreams
pkgbase=mingw-w64-${_realname}
pkgname="${MINGW_PACKAGE_PREFIX}-${_realname}"
pkgrel=1
pkgdesc="JTAG-SPI proxy bitstreams to be used with the OpenOCD jtagspi flash driver"
arch=('any')
mingw_arch=('mingw32' 'mingw64' 'ucrt64' 'clang64' 'clang32' 'clangarm64')
url="https://github.com/quartiq/bscan_spi_bitstreams"
license=('MIT')
depends=("${MINGW_PACKAGE_PREFIX}-openocd")
source=("${_realname}.zip::https://github.com/quartiq/bscan_spi_bitstreams/archive/refs/heads/master.zip")
sha256sums=('bbdf9e51b94502a10119c3aa22f1e7c21c0d25273436e2749782c119e980c87e')

prepare(){
  cd ${srcdir}
  mv bscan_spi_bitstreams-master ${_realname} 
}

build() {
  cd ${srcdir}/${_realname}
}

package() {
  cd ${srcdir}/${_realname}
  mkdir -p "${pkgdir}${MINGW_PREFIX}/share/bscan-spi-bitstreams"
  install -Dm755 *.bit "${pkgdir}${MINGW_PREFIX}/share/bscan-spi-bitstreams"
  install -Dm644 LICENSE "${pkgdir}${MINGW_PREFIX}/share/licenses/${_realname}/LICENSE"
}

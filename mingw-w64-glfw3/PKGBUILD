# Maintainer: Martell Malone <martellmalone@gmail.com>

_realname=libglfw3
_mingw_suff=mingw-w64-${CARCH}
pkgname="${_mingw_suff}-${_realname}"
pkgver=3.0.3
pkgrel=1
pkgdesc="A free, open source, portable framework for OpenGL application development. (mingw-w64)"
arch=('any')
url="http://www.glfw.org/"
license=('custom:ZLIB')
depends=("${_mingw_suff}-libglew")
makedepends=()
optdepends=()
conflicts=()
source=(http://downloads.sourceforge.net/project/glfw/glfw/$pkgver/glfw-$pkgver.zip)
sha1sums=('ea60b805f7ad3f31527662e7e400fc156626da1c')

build() {
  cd "$srcdir/glfw-$pkgver"
  rm -rf "glfw-build"
  cd "glfw-build"
  mkdir "static"
  mkdir "shared"
  
  cd "shared"
  
  cmake -G"Ninja" -DCMAKE_INSTALL_PREFIX=${pkgdir} -DCMAKE_C_COMPILER=${CARCH}-w64-mingw32-gcc \
  -DBUILD_SHARED_LIBS=YES "$srcdir/glfw-$pkgver"
  ninja
  
  cd "../static"
  cmake -G"Ninja" -DCMAKE_INSTALL_PREFIX=${pkgdir} -DCMAKE_C_COMPILER=${CARCH}-w64-mingw32-gcc \
  -DBUILD_SHARED_LIBS=YES "$srcdir/glfw-$pkgver" -DBUILD_SHARED_LIBS=OFF
  ninja
}

package() {
  cd "$srcdir/glfw-$pkgver"
  cd "glfw-build"
  cd "shared"
  ninja install
  cd "../static"
  ninja install
}

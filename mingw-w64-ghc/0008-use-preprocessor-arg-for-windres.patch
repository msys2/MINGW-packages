diff --git a/compiler/GHC/SysTools/Tasks.hs b/compiler/GHC/SysTools/Tasks.hs
index 32c49d9099..e505305395 100644
--- a/compiler/GHC/SysTools/Tasks.hs
+++ b/compiler/GHC/SysTools/Tasks.hs
@@ -389,21 +389,21 @@ runWindres logger dflags args = traceToolCommand logger dflags "windres" $ do
   let cc = pgm_c dflags
       cc_args = map Option (sOpt_c (settings dflags))
       windres = pgm_windres dflags
-      opts = map Option (getOpts dflags opt_windres)
+      opts = getOpts dflags opt_windres ++ ["-E", "-xc", "-DRC_INVOKED"]
       quote x = "\"" ++ x ++ "\""
-      args' = -- If windres.exe and gcc.exe are in a directory containing
-              -- spaces then windres fails to run gcc. We therefore need
-              -- to tell it what command to use...
-              Option ("--preprocessor=" ++
-                      unwords (map quote (cc :
-                                          map showOpt opts ++
-                                          ["-E", "-xc", "-DRC_INVOKED"])))
-              -- ...but if we do that then if windres calls popen then
-              -- it can't understand the quoting, so we have to use
-              -- --use-temp-file so that it interprets it correctly.
-              -- See #1828.
-            : Option "--use-temp-file"
-            : args
+      args' = mconcat
+                -- If windres.exe and gcc.exe are in a directory containing
+                -- spaces then windres fails to run gcc. We therefore need
+                -- to tell it what command to use...
+              [ [Option ("--preprocessor=" ++ quote cc)]
+              , map (\o -> Option ("--preprocessor-arg=" ++ o)) opts
+                -- ...but if we do that then if windres calls popen then
+                -- it can't understand the quoting, so we have to use
+                -- --use-temp-file so that it interprets it correctly.
+                -- See #1828.
+              , [Option "--use-temp-file"]
+              , args
+              ]

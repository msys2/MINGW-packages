--- a/meson.build.orig
+++ b/meson.build
@@ -106,5 +106,4 @@
 
 subdir('src')
 subdir('docs')
-subdir('tests')
 
--- a/src/platform/endian.h.orig
+++ b/src/platform/endian.h
@@ -59,8 +59,8 @@
 #define bswap_32(x) BSWAP_32(x)
 #define bswap_64(x) BSWAP_64(x)
 
-#elif defined(__ANDROID__) || defined(__CYGWIN__) || defined(__GNUC__) || \
-	defined(__GNU__)
+#elif defined(__ANDROID__) || defined(__CYGWIN__) || (defined(__GNUC__) || \
+	defined(__GNU__)) && !defined(__MINGW32__)
 
 #include <byteswap.h>
 #include <endian.h>
--- q/src/provider.h.orig
+++ b/src/provider.h
@@ -10,9 +10,18 @@
 #include "config.h"
 
 #include <stdbool.h>
+#if defined(_WIN32) && !defined(_MSC_VER)
+#include <pthread.h>
+#endif
 #include <sys/types.h>
 
+#ifdef _WIN32
+#pragma pack(push, 1)
+#endif
 #include "pkcs11.h"
+#ifdef _WIN32
+#pragma pack(pop)
+#endif
 #include <openssl/core_dispatch.h>
 #include <openssl/core_object.h>
 #include <openssl/types.h>

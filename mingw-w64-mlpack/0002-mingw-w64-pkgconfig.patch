diff --unified --recursive --text mlpack-3.4.2.orig/CMake/mlpack.pc.in mlpack-3.4.2.new/CMake/mlpack.pc.in
--- mlpack-3.4.2.orig/CMake/mlpack.pc.in	2020-10-28 12:10:49.000000000 -0400
+++ mlpack-3.4.2.new/CMake/mlpack.pc.in	2022-07-11 10:41:58.804470800 -0400
@@ -1,6 +1,12 @@
 Name: mlpack
 Description: scalable C++ machine learning library
 URL: http://www.mlpack.org/
+
+prefix="@CMAKE_INSTALL_PREFIX@"
+exec_prefix="${prefix}"
+libdir="${exec_prefix}/lib"
+includedir="${prefix}/include"
+
 Version: @MLPACK_VERSION_STRING@
-Cflags: @MLPACK_INCLUDE_DIRS_STRING@
-Libs: @MLPACK_LIBRARIES_STRING@
+CFlags: -I${includedir} -I${includedir}/stb
+Libs: -L${libdir} @MLPACK_LIBRARIES_STRING@
diff --unified --recursive --text mlpack-3.4.2.orig/CMakeLists.txt mlpack-3.4.2.new/CMakeLists.txt
--- mlpack-3.4.2.orig/CMakeLists.txt	2022-07-11 09:38:46.880663200 -0400
+++ mlpack-3.4.2.new/CMakeLists.txt	2022-07-11 10:42:34.454613600 -0400
@@ -680,25 +680,13 @@
 
   # Create the list of link directories.
   set(MLPACK_LIBRARIES_LIST)
-  foreach (linkdir ${MLPACK_LIBRARY_DIRS})
-    list(APPEND MLPACK_LIBRARIES_LIST "-L${linkdir}")
-  endforeach ()
 
   foreach(lib ${MLPACK_LIBRARIES})
     string(SUBSTRING "${lib}" 0 1 first)
-    if ("${first}" STREQUAL "/")
-      # We need to split the directory and the library.
-      string(REGEX REPLACE "(.*/)[^/]*$" "\\1" library_dir "${lib}")
-      string(REGEX REPLACE ".*/lib([^/]*)[.][a-z]*[.]*$" "\\1" library_name "${lib}")
-
-      list(APPEND MLPACK_LIBRARIES_LIST "-L${library_dir}")
-      list(APPEND MLPACK_LIBRARIES_LIST "-l${library_name}")
-    else ()
-      list(APPEND MLPACK_LIBRARIES_LIST "-l${lib}")
-    endif ()
+    string(REGEX REPLACE ".*/lib([^/]*).dll.a$" "\\1" library_name "${lib}")
+    list(APPEND MLPACK_LIBRARIES_LIST "-l${library_name}")
   endforeach ()
   # Don't forget to add mlpack as a dependency too.
-  list(APPEND MLPACK_LIBRARIES_LIST "-L${CMAKE_INSTALL_PREFIX}/lib/")
   list(APPEND MLPACK_LIBRARIES_LIST "-lmlpack")
 
   # Filter duplicate dependencies and directories.

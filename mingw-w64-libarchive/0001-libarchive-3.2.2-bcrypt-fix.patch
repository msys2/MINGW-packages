--- libarchive-3.2.2/CMakeLists.txt.orig	2016-10-31 06:44:48.210114100 -0400
+++ libarchive-3.2.2/CMakeLists.txt	2016-10-31 07:07:35.977487200 -0400
@@ -1006,6 +1006,22 @@
 ENDIF(ENABLE_ICONV)
 
 #
+# Find Bcrypt library on Windows and MSYS
+#
+IF(HAVE_BCRYPT_H)
+  IF((WIN32 AND NOT CYGWIN) OR MSYS)
+    FIND_LIBRARY(BCRYPTLIB "Bcrypt")
+    IF(NOT BCRYPTLIB)
+      UNSET(HAVE_BCRYPT_H CACHE)
+      MESSAGE(STATUS "Bcrypt Library: Not Found")
+    ELSE(NOT BCRYPTLIB)
+      LIST(APPEND ADDITIONAL_LIBS ${BCRYPTLIB})
+      MESSAGE(STATUS "Found Bcrypt ${BCRYPTLIB}")
+    ENDIF(NOT BCRYPTLIB)
+  ENDIF((WIN32 AND NOT CYGWIN) OR MSYS)
+ENDIF(HAVE_BCRYPT_H)
+
+#
 # Find Libxml2
 #
 IF(ENABLE_LIBXML2)

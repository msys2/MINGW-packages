# Maintainer: Naveen M K <naveen@syrusdark.website> @naveen521kk on Github.

_realname=glslviewer
pkgbase=mingw-w64-${_realname}
pkgname=("${MINGW_PACKAGE_PREFIX}-${_realname}")
pkgver=1.6.1
pkgrel=1
pkgdesc=" Console-based GLSL Sandbox for 2D/3D shaders shaders (mingw-w64)"
arch=('any')
url="https://github.com/patriciogonzalezvivo/glslViewer"
license=('BSD-3-Clause')
depends=(
  "${MINGW_PACKAGE_PREFIX}-glfw"
  "${MINGW_PACKAGE_PREFIX}-glew"
)
source=(
  "${_realname}-${pkgver}.tar.gz"::"https://github.com/patriciogonzalezvivo/glslViewer/archive/${pkgver}.tar.gz"
  '0001-add-mingw.patch'
  '0002-use-platform-windows-def.patch'
)
sha512sums=('f8c1bfbc89d90d187f66c9a81e4f6eaee22225c66d88d5149dfdfba3db9b6812ebca783d8fd48c05c56da6a3c56cdb928807da47759254eba6d9038fff373fe9'
            '5f602ad94243172edee1d087433fc7d7e42b4c63f24a0e59b86838e4bd7084553d63c7e65834d56161fc812b908cd221e8bcc7d9fd0ff637127de38add086d34'
            'e75585948dfc6144979874b4e9e78c503b584da446ec3ad446ef72e43f04995797a72bc78cbf9732b2866c17095c270b7d2c1ffefab8d99e89ba0b5a53e02b4c')

prepare () {
  cd ${srcdir}/${_realname}-${pkgver}
  patch -Np1 -i ${srcdir}/0001-add-mingw.patch
  patch -Np1 -i ${srcdir}/0002-use-platform-windows-def.patch
  rm -r include/glew-2.1.0/*
}

build() {
  cd ${srcdir}/${_realname}-${pkgver}
  make
}

package() {
  install -Dm0755 "${srcdir}/${_realname}-${pkgver}/bin/glslViewer.exe" "${pkgdir}${MINGW_PREFIX}/bin/glslViewer.exe"
  install -Dm0755 "${srcdir}/${_realname}-${pkgver}/bin/glslLoader" "${pkgdir}${MINGW_PREFIX}/bin/glslLoader"
  install -Dm644 "${srcdir}/${_realname}-${pkgver}/LICENSE" "${pkgdir}${MINGW_PREFIX}/share/licenses/${_realname}/LICENSE.md"
}

--- a/Makerules
+++ b/Makerules
@@ -212,6 +212,11 @@
   CFLAGS += -DCLUSTER
 endif
 
+ifeq ($(OS),$(filter $(OS),Linux MINGW Windows_NT))
+  WINDRES := windres
+  HAVE_WIN32 := yes
+endif
+
 ifeq ($(OS),Darwin)
   HAVE_GLUT := yes
   SYS_GLUT_CFLAGS := -Wno-deprecated-declarations
--- a/Makefile
+++ b/Makefile
@@ -36,6 +36,11 @@
   endif
 endif
 
+ifeq ($(HAVE_WIN32),yes)
+  WIN32_LIBS := -lcomdlg32 -lgdi32
+  WIN32_LDFLAGS := -Wl,-subsystem,windows
+endif
+
 VERSION_MAJOR = $(shell grep "define FZ_VERSION_MAJOR" include/mupdf/fitz/version.h | cut -d ' ' -f 3)
 VERSION_MINOR = $(shell grep "define FZ_VERSION_MINOR" include/mupdf/fitz/version.h | cut -d ' ' -f 3)
 VERSION_PATCH = $(shell grep "define FZ_VERSION_PATCH" include/mupdf/fitz/version.h | cut -d ' ' -f 3)
@@ -66,6 +66,7 @@
   QUIET_LINK_SO = @ echo "    LINK_SO $@" ;
   QUIET_RM = @ echo "    RM $@" ;
   QUIET_TAGS = @ echo "    TAGS $@" ;
+  QUIET_WINDRES = @ echo "    WINDRES $@" ;
   QUIET_OBJCOPY = @ echo "    OBJCOPY $@" ;
   QUIET_SYMLINK = @ echo "    SYMLINK $@" ;
 endif
@@ -81,5 +82,6 @@
 ifdef RANLIB
   RANLIB_CMD = $(QUIET_RANLIB) $(RANLIB) $@
 endif
+WINDRES_CMD = $(QUIET_WINDRES) $(MKTGTDIR) ; $(WINDRES) $< $@
 LINK_CMD = $(QUIET_LINK) $(MKTGTDIR) ; $(CC) $(EXE_LDFLAGS) $(LDFLAGS) -o $@ $^ $(LIBS)
 TAGS_CMD = $(QUIET_TAGS) ctags
@@ -160,6 +162,9 @@
 $(OUT)/platform/%.o : platform/%.c
 	$(CC_CMD) $(WARNING_CFLAGS)
 
+$(OUT)/%.o: %.rc
+	$(WINDRES_CMD)
+
 .PRECIOUS : $(OUT)/%.o # Keep intermediates from chained rules
 
 # --- File lists ---
@@ -353,6 +358,9 @@
 ifeq ($(HAVE_GLUT),yes)
   MUVIEW_GLUT_SRC += $(sort $(wildcard platform/gl/*.c))
   MUVIEW_GLUT_OBJ := $(MUVIEW_GLUT_SRC:%.c=$(OUT)/%.o)
+ifeq ($(HAVE_WIN32),yes)
+  MUVIEW_GLUT_OBJ += $(OUT)/platform/gl/gl-winres.o
+endif
   MUVIEW_GLUT_EXE := $(OUT)/mupdf-gl
   $(MUVIEW_GLUT_EXE) : $(MUVIEW_GLUT_OBJ) $(MUPDF_LIB) $(THIRD_LIB) $(THIRD_GLUT_LIB) $(PKCS7_LIB)
 	$(LINK_CMD) $(THIRD_LIBS) $(LIBCRYPTO_LIBS) $(THIRD_GLUT_LIBS)
@@ -369,6 +377,16 @@
   VIEW_APPS += $(MUVIEW_X11_EXE)
 endif
 
+ifeq ($(HAVE_WIN32),yes)
+  MUVIEW_WIN32_EXE := $(OUT)/mupdf-w32
+  MUVIEW_WIN32_OBJ += $(OUT)/platform/x11/pdfapp.o
+  MUVIEW_WIN32_OBJ += $(OUT)/platform/x11/win_main.o
+  MUVIEW_WIN32_OBJ += $(OUT)/platform/x11/win_res.o
+  $(MUVIEW_WIN32_EXE) : $(MUVIEW_WIN32_OBJ) $(MUPDF_LIB) $(THIRD_LIB) $(PKCS7_LIB)
+	$(LINK_CMD) $(THIRD_LIBS) $(WIN32_LDFLAGS) $(WIN32_LIBS) $(LIBCRYPTO_LIBS)
+  VIEW_APPS += $(MUVIEW_WIN32_EXE)
+endif
+
 ifeq ($(HAVE_X11),yes)
 ifeq ($(HAVE_CURL),yes)
 ifeq ($(HAVE_PTHREAD),yes)


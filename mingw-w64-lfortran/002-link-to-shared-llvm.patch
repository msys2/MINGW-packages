--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -271,7 +271,7 @@
         add_definitions("-DHAVE_TARGET_WASM=1")
     endif()
 
-    if (TARGET LLVMCore)
+    if (TARGET LLVMCore AND NOT LLVM_LINK_LLVM_DYLIB)
         # If `LLVMCore` target is present, then LLVM is distributed as separate
         # libraries and llvm_map_components_to_libnames() should work:
         llvm_map_components_to_libnames(llvm_libs ${LFORTRAN_LLVM_COMPONENTS})

--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -86,10 +86,10 @@
 else (USE_EXT_GD)
 
 	MACRO(GV VER VAR)
-		execute_process(
-			COMMAND ${CMAKE_CURRENT_SOURCE_DIR}/config/getver.sh ${VER}
-			OUTPUT_VARIABLE ${VAR}
-		)
+		file (STRINGS "src/gd.h" _VERSION_LINE REGEX "define[ ]+GD_${VER}_VERSION")
+		if ( _VERSION_LINE )
+			string ( REGEX REPLACE ".*define[ ]+GD_${VER}_VERSION[ ]+\"?([^ \"]*)\"?[ ]+.*" "\\1" ${VAR} "${_VERSION_LINE}" )
+		endif ()
 	ENDMACRO(GV)
 
 	GV(MAJOR GDLIB_MAJOR)

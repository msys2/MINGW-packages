# Based on: https://aur.archlinux.org/packages/adasat

_realname=adasat
pkgbase=mingw-w64-${_realname}
pkgname=${MINGW_PACKAGE_PREFIX}-${_realname}
pkgver=24.0.0
pkgrel=1

pkgdesc="Implementation of a DPLL-based SAT solver in Ada (mingw-w64)"
arch=('any')
mingw_arch=('mingw32' 'mingw64' 'ucrt64')

url="https://github.com/AdaCore/AdaSAT"
license=('spdx:Apache-2.0 WITH LLVM-exception')
makedepends=("${MINGW_PACKAGE_PREFIX}-gcc-ada"
             "${MINGW_PACKAGE_PREFIX}-gprbuild"
             "git")
depends=()
source=("https://github.com/AdaCore/AdaSAT/archive/v${pkgver}/${_realname}-${pkgver}.tar.gz")
sha256sums=('7601774c928e5bb73971fce3b3942b4609a71386230690f8c130e9f708adbfd6')

build() {
  cd "${srcdir}/${_realname}-${pkgver}"

  BUILD_MODE=prod \
  make all-libs
}

package() {
  cd "${srcdir}/${_realname}-${pkgver}"

  BUILD_MODE=prod \
  INSTALL_DIR=${pkgdir}/${MINGW_PREFIX} \
  make install

  # Copy License Files
  install -Dm644 -t "${pkgdir}/${MINGW_PREFIX}/share/licenses/${_realname}" \
    ${srcdir}/${_realname}-${pkgver}/LICENSE
}

From 6140036e3911fd12a37cfa77e221ba520c45ff8c Mon Sep 17 00:00:00 2001
From: Naveen M K <naveen521kk@gmail.com>
Date: Mon, 1 Jan 2024 13:42:01 +0530
Subject: [PATCH 073/N] configure: fix multiprocessing module

`ws2_32` is required when building that module
---
 configure.ac | 9 ++++++++-
 1 file changed, 8 insertions(+), 1 deletion(-)

diff --git a/configure.ac b/configure.ac
index 01e1422..f07e30b 100644
--- a/configure.ac
+++ b/configure.ac
@@ -4539,6 +4539,13 @@ AS_CASE([$MACHDEP],
   [SOCKET_LIBS=""]
 )
 
+dnl On MINGW, you need to link againt ws2_32 for _multiprocessing
+AS_CASE([$MACHDEP],
+  [win32], [MULTIPROCESSING_LIBS="-lws2_32"],
+  [MULTIPROCESSING_LIBS=""]
+)
+
+
 dnl detect sqlite3 from Emscripten emport
 PY_CHECK_EMSCRIPTEN_PORT([LIBSQLITE3], [-sUSE_SQLITE3])
 
@@ -8330,7 +8337,7 @@ PY_STDLIB_MOD_SIMPLE([_zoneinfo])
 dnl multiprocessing modules
 PY_STDLIB_MOD([_multiprocessing],
   [], [test "$ac_cv_func_sem_unlink" = "yes" -o "$MACHDEP" = "win32"],
-  [-I\$(srcdir)/Modules/_multiprocessing])
+  [-I\$(srcdir)/Modules/_multiprocessing], [$MULTIPROCESSING_LIBS])
 PY_STDLIB_MOD([_posixshmem],
   [], [test "$have_posix_shmem" = "yes"],
   [$POSIXSHMEM_CFLAGS], [$POSIXSHMEM_LIBS])

diff -urN gdal-3.3.3-orig/gcore/gdal_priv.h gdal-3.3.3/gcore/gdal_priv.h
--- gdal-3.3.3-orig/gcore/gdal_priv.h	2021-10-25 19:40:04 +0800
+++ gdal-3.3.3/gcore/gdal_priv.h	2021-11-05 23:43:45 +0800
@@ -338,12 +338,12 @@
 /** A set of associated raster bands, usually from one file. */
 class CPL_DLL GDALDataset : public GDALMajorObject
 {
-    friend GDALDatasetH CPL_STDCALL GDALOpenEx( const char* pszFilename,
+    friend GDALDatasetH CPL_DLL CPL_STDCALL GDALOpenEx( const char* pszFilename,
                                  unsigned int nOpenFlags,
                                  const char* const* papszAllowedDrivers,
                                  const char* const* papszOpenOptions,
                                  const char* const* papszSiblingFiles );
-    friend void CPL_STDCALL GDALClose( GDALDatasetH hDS );
+    friend void CPL_DLL CPL_STDCALL GDALClose( GDALDatasetH hDS );
 
     friend class GDALDriver;
     friend class GDALDefaultOverviews;
diff -urN gdal-3.3.3-orig/gnm/gnm_frmts/db/gnmdbdriver.cpp gdal-3.3.3/gnm/gnm_frmts/db/gnmdbdriver.cpp
--- gdal-3.3.3-orig/gnm/gnm_frmts/db/gnmdbdriver.cpp	2021-10-25 19:40:03 +0800
+++ gdal-3.3.3/gnm/gnm_frmts/db/gnmdbdriver.cpp	2021-11-05 23:54:02 +0800
@@ -103,7 +103,7 @@
     return poFN->Delete();
 }
 
-void RegisterGNMDatabase()
+void CPL_DLL RegisterGNMDatabase()
 {
     if( GDALGetDriverByName( "GNMDatabase" ) == nullptr )
     {
diff -urN gdal-3.3.3-orig/gnm/gnm_frmts/file/gnmfiledriver.cpp gdal-3.3.3/gnm/gnm_frmts/file/gnmfiledriver.cpp
--- gdal-3.3.3-orig/gnm/gnm_frmts/file/gnmfiledriver.cpp	2021-10-25 19:40:03 +0800
+++ gdal-3.3.3/gnm/gnm_frmts/file/gnmfiledriver.cpp	2021-11-05 23:53:31 +0800
@@ -124,7 +124,7 @@
     return oFN.Delete();
 }
 
-void RegisterGNMFile()
+void CPL_DLL RegisterGNMFile()
 {
     if( GDALGetDriverByName( "GNMFile" ) == nullptr )
     {
diff -urN gdal-3.4.0-orig/alg/gdalchecksum.cpp gdal-3.4.0/alg/gdalchecksum.cpp
--- gdal-3.4.0-orig/alg/gdalchecksum.cpp	2021-11-04 19:57:00 +0800
+++ gdal-3.4.0/alg/gdalchecksum.cpp	2021-11-10 18:28:50 +0800
@@ -62,7 +62,7 @@
  * @return Checksum value.
  */
 
-int CPL_STDCALL
+int CPL_DLL CPL_STDCALL
 GDALChecksumImage( GDALRasterBandH hBand,
                    int nXOff, int nYOff, int nXSize, int nYSize )
 
diff -urN gdal-3.4.0-orig/frmts/pcraster/pcrastermisc.cpp gdal-3.4.0/frmts/pcraster/pcrastermisc.cpp
--- gdal-3.4.0-orig/frmts/pcraster/pcrastermisc.cpp	2021-11-04 19:58:08 +0800
+++ gdal-3.4.0/frmts/pcraster/pcrastermisc.cpp	2021-11-15 23:03:47 +0800
@@ -32,7 +32,7 @@
 
 CPL_CVSID("$Id: pcrastermisc.cpp f6099e5ed704166bf5cc113a053dd1b2725cb391 2020-03-22 11:20:10 +0100 Kai Pastor $")
 
-void GDALRegister_PCRaster()
+void CPL_DLL GDALRegister_PCRaster()
 {
     if( !GDAL_CHECK_VERSION( "PCRaster driver" ) )
         return;
diff -urN gdal-3.4.0-orig/port/cpl_error.cpp gdal-3.4.0/port/cpl_error.cpp
--- gdal-3.4.0-orig/port/cpl_error.cpp	2021-11-04 19:58:51 +0800
+++ gdal-3.4.0/port/cpl_error.cpp	2021-11-15 18:56:30 +0800
@@ -1382,7 +1382,7 @@
 /************************************************************************/
 
 static
-void CPL_STDCALL CPLErrorHandlerAccumulator( CPLErr eErr, CPLErrorNum no,
+void CPL_DLL CPLErrorHandlerAccumulator( CPLErr eErr, CPLErrorNum no,
                                               const char* msg )
 {
     std::vector<CPLErrorHandlerAccumulatorStruct>* paoErrors =
@@ -1392,12 +1392,12 @@
 }
 
 
-void CPLInstallErrorHandlerAccumulator(std::vector<CPLErrorHandlerAccumulatorStruct>& aoErrors)
+void CPL_DLL CPLInstallErrorHandlerAccumulator(std::vector<CPLErrorHandlerAccumulatorStruct>& aoErrors)
 {
     CPLPushErrorHandlerEx( CPLErrorHandlerAccumulator, &aoErrors );
 }
 
-void CPLUninstallErrorHandlerAccumulator()
+void CPL_DLL CPLUninstallErrorHandlerAccumulator()
 {
     CPLPopErrorHandler();
 }

From 696df8fe54bd8f1bb0580a6d11597916af883166 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?U=C4=9Fur=20Kurnaz?= <bay.ugur.kurnaz@gmail.com>
Date: Fri, 18 Mar 2022 18:22:46 +0100
Subject: [PATCH 11/12] detect_gstreamer_with_pkg_config_first

---
 modules/videoio/cmake/detect_gstreamer.cmake | 30 ++++++++++----------
 1 file changed, 15 insertions(+), 15 deletions(-)

diff --git a/modules/videoio/cmake/detect_gstreamer.cmake b/modules/videoio/cmake/detect_gstreamer.cmake
index fc6c347..cc827e2 100644
--- a/modules/videoio/cmake/detect_gstreamer.cmake
+++ b/modules/videoio/cmake/detect_gstreamer.cmake
@@ -1,4 +1,19 @@
 # --- GStreamer ---
+if(NOT HAVE_GSTREAMER AND PKG_CONFIG_FOUND)
+  ocv_check_modules(GSTREAMER_base gstreamer-base-1.0)
+  ocv_check_modules(GSTREAMER_app gstreamer-app-1.0)
+  ocv_check_modules(GSTREAMER_riff gstreamer-riff-1.0)
+  ocv_check_modules(GSTREAMER_pbutils gstreamer-pbutils-1.0)
+  ocv_check_modules(GSTREAMER_video gstreamer-video-1.0)
+  ocv_check_modules(GSTREAMER_audio gstreamer-audio-1.0)
+  if(GSTREAMER_base_FOUND AND GSTREAMER_app_FOUND AND GSTREAMER_riff_FOUND AND GSTREAMER_pbutils_FOUND AND GSTREAMER_video_FOUND AND GSTREAMER_audio_FOUND)
+    set(HAVE_GSTREAMER TRUE)
+    set(GSTREAMER_VERSION ${GSTREAMER_base_VERSION})  # informational
+    set(GSTREAMER_LIBRARIES ${GSTREAMER_base_LIBRARIES} ${GSTREAMER_app_LIBRARIES} ${GSTREAMER_riff_LIBRARIES} ${GSTREAMER_pbutils_LIBRARIES} ${GSTREAMER_video_LIBRARIES} ${GSTREAMER_audio_LIBRARIES})
+    set(GSTREAMER_INCLUDE_DIRS ${GSTREAMER_base_INCLUDE_DIRS} ${GSTREAMER_app_INCLUDE_DIRS} ${GSTREAMER_riff_INCLUDE_DIRS} ${GSTREAMER_pbutils_INCLUDE_DIRS} ${GSTREAMER_video_INCLUDE_DIRS} ${GSTREAMER_audio_INCLUDE_DIRS})
+  endif()
+endif()
+
 if(NOT HAVE_GSTREAMER AND WIN32)
   set(env_paths "${GSTREAMER_DIR}" ENV GSTREAMER_ROOT)
   if(X86_64)
@@ -87,21 +102,6 @@ if(NOT HAVE_GSTREAMER AND WIN32)
   endif()
 endif()
 
-if(NOT HAVE_GSTREAMER AND PKG_CONFIG_FOUND)
-  ocv_check_modules(GSTREAMER_base gstreamer-base-1.0)
-  ocv_check_modules(GSTREAMER_app gstreamer-app-1.0)
-  ocv_check_modules(GSTREAMER_riff gstreamer-riff-1.0)
-  ocv_check_modules(GSTREAMER_pbutils gstreamer-pbutils-1.0)
-  ocv_check_modules(GSTREAMER_video gstreamer-video-1.0)
-  ocv_check_modules(GSTREAMER_audio gstreamer-audio-1.0)
-  if(GSTREAMER_base_FOUND AND GSTREAMER_app_FOUND AND GSTREAMER_riff_FOUND AND GSTREAMER_pbutils_FOUND AND GSTREAMER_video_FOUND AND GSTREAMER_audio_FOUND)
-    set(HAVE_GSTREAMER TRUE)
-    set(GSTREAMER_VERSION ${GSTREAMER_base_VERSION})  # informational
-    set(GSTREAMER_LIBRARIES ${GSTREAMER_base_LIBRARIES} ${GSTREAMER_app_LIBRARIES} ${GSTREAMER_riff_LIBRARIES} ${GSTREAMER_pbutils_LIBRARIES} ${GSTREAMER_video_LIBRARIES} ${GSTREAMER_audio_LIBRARIES})
-    set(GSTREAMER_INCLUDE_DIRS ${GSTREAMER_base_INCLUDE_DIRS} ${GSTREAMER_app_INCLUDE_DIRS} ${GSTREAMER_riff_INCLUDE_DIRS} ${GSTREAMER_pbutils_INCLUDE_DIRS} ${GSTREAMER_video_INCLUDE_DIRS} ${GSTREAMER_audio_INCLUDE_DIRS})
-  endif()
-endif()
-
 if(HAVE_GSTREAMER)
   ocv_add_external_target(gstreamer "${GSTREAMER_INCLUDE_DIRS}" "${GSTREAMER_LIBRARIES}" "HAVE_GSTREAMER")
 endif()
-- 
2.35.1


From 31cf4b1ff245e0456a1f9b47fd818ed560afb259 Mon Sep 17 00:00:00 2001
From: Orgad Shaneh <orgads@gmail.com>
Date: Wed, 5 Jun 2019 08:55:57 +0300
Subject: [PATCH] CMake: Use symlinks also on MSYS

---
 cmake/modules/AddLLVM.cmake            | 4 ++--
 cmake/modules/LLVMInstallSymlink.cmake | 2 +-
 2 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/cmake/modules/AddLLVM.cmake b/cmake/modules/AddLLVM.cmake
index 1a417447278..febf2c0e9b6 100644
--- a/cmake/modules/AddLLVM.cmake
+++ b/cmake/modules/AddLLVM.cmake
@@ -1505,7 +1505,7 @@ function(add_llvm_tool_symlink link_name target)
   if(NOT ARG_OUTPUT_DIR)
     # If you're not overriding the OUTPUT_DIR, we can make the link relative in
     # the same directory.
-    if(CMAKE_HOST_UNIX)
+    if(CMAKE_HOST_UNIX OR MSYS)
       set(dest_binary "$<TARGET_FILE_NAME:${target}>")
     endif()
     if(CMAKE_CONFIGURATION_TYPES)
@@ -1531,7 +1531,7 @@ function(add_llvm_tool_symlink link_name target)
     endif()
   endif()
 
-  if(CMAKE_HOST_UNIX)
+  if(CMAKE_HOST_UNIX OR MSYS)
     set(LLVM_LINK_OR_COPY create_symlink)
   else()
     set(LLVM_LINK_OR_COPY copy)
diff --git a/cmake/modules/LLVMInstallSymlink.cmake b/cmake/modules/LLVMInstallSymlink.cmake
index 1a04de931ff..7c5d50ca53e 100644
--- a/cmake/modules/LLVMInstallSymlink.cmake
+++ b/cmake/modules/LLVMInstallSymlink.cmake
@@ -3,7 +3,7 @@
 # See PR8397.
 
 function(install_symlink name target outdir)
-  if(CMAKE_HOST_UNIX)
+  if(CMAKE_HOST_UNIX OR MSYS)
     set(LINK_OR_COPY create_symlink)
     set(DESTDIR $ENV{DESTDIR})
   else()
-- 
2.21.0.windows.1


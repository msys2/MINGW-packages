# Maintainer: J. Peter Mugaas <jpmugaas@suddenlink.net>
#
#This software package is unusual because we don't compile the source-code itself.
#Rather, we donwload and repackage the precompiled binaries for i386 and x86_64 that
#don't include an installer.  This is because pandoc is written in Haskel and we don't
#have that yet as well as some Haskell libraries as well as other stuff.
#O am making this available because quite a number of things seem to require this
#package for doc conversions.

_realname=pandoc
pkgbase=mingw-w64-${_realname}
pkgname=("${MINGW_PACKAGE_PREFIX}-${_realname}")
pkgver=2.6
pkgrel=1
pkgdesc="Conversion between markup formats (mingw-w64)"
arch=('any')
url='https://www.somepackage.org/'
license=('GPL')
source=("https://github.com/jgm/pandoc/releases/download/2.6/${_realname}-$pkgver-windows-i386.zip"
        "https://github.com/jgm/pandoc/releases/download/2.6/${_realname}-$pkgver-windows-x86_64.zip")
noextract=("pandoc-2.6-windows-i386.zip"
           "pandoc-2.6-windows-x86_64.zip")
sha256sums=('4db6e82abe76f31d0ce0eb7091f9f0a5bcc3ab189d1e49858755cba4547996e6'
            '2849e722ccbf1983108ce285144a1408450b6c94cd5ef85848d8a70e71dab8c6')

package() {
  cd "${srcdir}"
  mkdir -p ${pkgdir}/${MINGW_PREFIX}/bin
  mkdir -p ${pkgdir}/${MINGW_PREFIX}/share/doc/${_realname}-$pkgver/html
  mkdir -p ${pkgdir}/${MINGW_PREFIX}/share/licenses/
  case "${CARCH}" in
    x86_64*)
        rm -rf ${_realname}-${pkgver}-windows-x86_64
        /usr/bin/unzip "${_realname}-$pkgver-windows-x86_64.zip"
        cp ${_realname}-${pkgver}-windows-x86_64/*.exe ${pkgdir}/${MINGW_PREFIX}/bin
        cp ${_realname}-${pkgver}-windows-x86_64/*.html ${pkgdir}/${MINGW_PREFIX}/share/doc/${_realname}-$pkgver/html
        cp ${_realname}-${pkgver}-windows-x86_64/COPYING.rtf ${pkgdir}/${MINGW_PREFIX}/share/licenses/
        cp ${_realname}-${pkgver}-windows-x86_64/COPYRIGHT.txt ${pkgdir}/${MINGW_PREFIX}/share/licenses/
        ;;
    i686*)
        rm -rf ${_realname}-${pkgver}-windows-i386
        /usr/bin/unzip "${_realname}-$pkgver-windows-i386.zip"
        cp ${_realname}-${pkgver}-windows-i386/*.exe ${pkgdir}/${MINGW_PREFIX}/bin
        cp ${_realname}-${pkgver}-windows-i386/*.html ${pkgdir}/${MINGW_PREFIX}/share/doc/${_realname}-$pkgver/html
        cp ${_realname}-${pkgver}-windows-i386/COPYING.rtf ${pkgdir}/${MINGW_PREFIX}/share/licenses/
        cp ${_realname}-${pkgver}-windows-i386/COPYRIGHT.txt ${pkgdir}/${MINGW_PREFIX}/share/licenses/
        ;;
  esac
}

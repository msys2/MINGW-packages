# Maintainer: <matheus-catarino@hotmail.com>

_realname=pgmodeler
pkgbase=mingw-w64-${_realname}
pkgname="${MINGW_PACKAGE_PREFIX}-${_realname}"
pkgver=0.9.2
pkgrel=1
pkgdesc="PostgreSQL Database Modeler - is an open source data modeling tool designed for PostgreSQL.(mingw-w64)"
arch=('any')
url="https://github.com/${_realname}/${_realname}"
license=("GPL3")
depends=("${MINGW_PACKAGE_PREFIX}-qt5" "${MINGW_PACKAGE_PREFIX}-postgresql" "${MINGW_PACKAGE_PREFIX}-libxml2")
makedepends=("${MINGW_PACKAGE_PREFIX}-gcc")
source=("${_realname}-${pkgver}.tar.gz"::"https://github.com/${_realname}/${_realname}/archive/v${pkgver}.tar.gz")
sha256sums=('24710d07f67eb6b0757b5a50d179feb811a87f4dda505ed42a276fb2bbf03bfc')

prepare() {
    cd ${srcdir}/${_realname}-${pkgver}

    patch -Np1 -i ../../fix_libxml2.patch
}

build() {
    cd ${srcdir}/${_realname}-${pkgver}
    ${MINGW_PREFIX}/bin/qmake -r \
    CONFIG+=release \
    PREFIX=${MINGW_PREFIX} \
    CONFDIR=${MINGW_PREFIX}/etc/pgmodeler \
    PRIVATEBINDIR=${MINGW_PREFIX}/bin \
    DOCDIR=${MINGW_PREFIX}/share/doc/pgmodeler \
    SAMPLESDIR=${MINGW_PREFIX}/share/doc/pgmodeler \
    pgmodeler.pro
    
    make
}

package() {
    cd ${srcdir}/${_realname}-${pkgver}
    make install
}

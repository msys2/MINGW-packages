From e79dfc7e19dbad41dfa44291189bd48463e32c27 Mon Sep 17 00:00:00 2001
From: Alexey Pavlov <alexpux@gmail.com>
Date: Thu, 28 Aug 2025 12:13:35 +0300
Subject: [PATCH 120/N] There are no more MSI module

---
 Makefile.pre.in         | 1 -
 Modules/Setup.stdlib.in | 1 -
 configure.ac            | 4 +---
 3 files changed, 1 insertion(+), 5 deletions(-)

diff --git a/Makefile.pre.in b/Makefile.pre.in
index 5882484..0f73ca4 100644
--- a/Makefile.pre.in
+++ b/Makefile.pre.in
@@ -2397,7 +2397,6 @@ LIBSUBDIRS=	asyncio \
 		tkinter \
 		tomllib \
 		turtledemo \
-		msilib \
 		unittest \
 		urllib \
 		venv venv/scripts venv/scripts/common venv/scripts/posix \
diff --git a/Modules/Setup.stdlib.in b/Modules/Setup.stdlib.in
index 2940470..cd7c2e9 100644
--- a/Modules/Setup.stdlib.in
+++ b/Modules/Setup.stdlib.in
@@ -159,7 +159,6 @@
 # Windows specific modules
 
 @MODULE__OVERLAPPED_TRUE@_overlapped overlapped.c
-@MODULE__MSI_TRUE@_msi ../PC/_msi.c
 @MODULE_WINSOUND_TRUE@winsound ../PC/winsound.c
 
 
diff --git a/configure.ac b/configure.ac
index ebf01bc..6253bd9 100644
--- a/configure.ac
+++ b/configure.ac
@@ -12,7 +12,7 @@ dnl
 # Set VERSION so we only need to edit in one place (i.e., here)
 m4_define([PYTHON_VERSION], [3.13])
 
-AC_PREREQ([2.69])
+AC_PREREQ([2.71])
 
 AC_INIT([python],[PYTHON_VERSION],[https://github.com/python/cpython/issues/])
 
@@ -8382,8 +8382,6 @@ PY_STDLIB_MOD([_hashlib], [], [test "$ac_cv_working_openssl_hashlib" = yes],
 dnl windows specific modules
 PY_STDLIB_MOD([msvcrt], [test "$MACHDEP" = "win32"])
 PY_STDLIB_MOD([_winapi], [test "$MACHDEP" = "win32"])
-PY_STDLIB_MOD([_msi], [test "$MACHDEP" = "win32"], [], [],
-  [-lmsi -lcabinet -lrpcrt4])
 PY_STDLIB_MOD([winsound], [test "$MACHDEP" = "win32"], [], [],
   [-lwinmm])
 PY_STDLIB_MOD([_overlapped], [test "$MACHDEP" = "win32"], [], [],

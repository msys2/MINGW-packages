# Maintainer: J. Peter Mugaas <jpmugaas@suddenlink.net>

_realname=unicode-character-database
pkgbase=mingw-w64-${_realname}
pkgname="${MINGW_PACKAGE_PREFIX}-${_realname}"
pkgver=17.0.0
pkgrel=1
pkgdesc="Unicode Character Database (mingw-w64)"
arch=(any)
mingw_arch=('mingw64' 'ucrt64' 'clang64' 'clangarm64')
license=(BSD)
url="https://www.unicode.org/"
source=("UCD-${pkgver}.zip::https://www.unicode.org/Public/${pkgver}/ucd/UCD.zip"
        "Unihan-${pkgver}.zip::https://www.unicode.org/Public/${pkgver}/ucd/Unihan.zip"
        'LICENSE::https://www.unicode.org/license.txt')
noextract=({UCD,Unihan}-$pkgver.zip)
sha512sums=('34bf4f3760b72f34d31b9135820458a92efc01be4e068446031849ba8e36b9e30adecb2b7721239441cc026e70a33ad780a753464a6a635cea222c34767755d6'
            '8b0d117fed39600c62864dd0c955b2fe0a52cfc975288fcf58cb770aaf476355f52b2a603e11330184a07d89c705c0fea55eeb9a044c8f1ba3ba79f5f32d0b33'
            '1e067c231e85eef83896ad692393e50104bdfdd4743060e70c5e7bef0d0bd34d9554c0235e51a47caef626b36ae4a3dfb50cd26ddfe2b8160877da95472911fd')

package() {
  for _f in UCD Unihan; do
    install -Dm644 ${_f}-${pkgver}.zip "${pkgdir}${MINGW_PREFIX}/share/unicode/${_f}.zip"
    bsdtar -C "${pkgdir}${MINGW_PREFIX}/share/unicode" -x --no-same-owner --no-same-permissions -f $_f-$pkgver.zip
  done

  #  ln -s unicode "$pkgdir${MINGW_PREFIX}/share/${_realname}"
  # FS#49938: A bunch of compatibility symlinks
  mkdir -p "${pkgdir}"${MINGW_PREFIX}/share/unicode/ucd
  cp -r * "${pkgdir}${MINGW_PREFIX}/share/unicode/ucd/"
  for _f in ${_realname} unicode-data unidata; do
    cp -r "${pkgdir}"${MINGW_PREFIX}/share/unicode "${pkgdir}${MINGW_PREFIX}/share/${_f}/"
  done

  install -Dm644 LICENSE "${pkgdir}${MINGW_PREFIX}/share/licenses/${_realname}/LICENSE"
}

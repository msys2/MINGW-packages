--- a/lib/fdleak.c
+++ b/lib/fdleak.c
@@ -390,6 +396,7 @@
   int no_leaks = 1;
   const int leaking_fd = find_first_leaked_fd (non_cloexec_fds, num_cloexec_fds);
 
+#if !defined(__MINGW32__) && !defined(_MSC_VER)
   if (leaking_fd >= 0)
     {
       no_leaks = 0;
@@ -399,5 +406,6 @@
 	       "way to reproduce this problem."),
 	     leaking_fd);
     }
+#endif
   assert (no_leaks);
 }

--- a/lib/buildcmd.c
+++ b/lib/buildcmd.c
@@ -488,7 +488,11 @@
    * possible value for ARG_MAX on a POSIX compliant system.  See
    * https://www.opengroup.org/onlinepubs/009695399/basedefs/limits.h.html
    */
+#if defined(__MINGW32__) || defined(_MSC_VER)
+  ctl->posix_arg_size_min = 2048L;
+#else  
   ctl->posix_arg_size_min = _POSIX_ARG_MAX;
+#endif
   ctl->posix_arg_size_max = bc_get_arg_max ();
 
   ctl->exit_if_size_exceeded = 0;
--- a/lib/fdleak.c
+++ b/lib/fdleak.c
@@ -115,9 +115,15 @@
   if (open_max >= 0)
     return open_max;
 
+#if defined(__MINGW32__) || defined(_MSC_VER)
+  open_max = getdtablesize ();
+  if (open_max == -1)
+    open_max = 16;
+#else  
   open_max = sysconf (_SC_OPEN_MAX);
   if (open_max == -1)
     open_max = _POSIX_OPEN_MAX;	/* underestimate */
+#endif
 
   /* We assume if RLIMIT_NOFILE is defined, all the related macros are, too. */
 #if defined HAVE_GETRLIMIT && defined RLIMIT_NOFILE
--- a/xargs/xargs.c
+++ b/xargs/xargs.c
@@ -70,6 +70,20 @@
 #include "gcc-function-attributes.h"
 #include "system.h"
 
+#if defined(__MINGW32__) || defined(_MSC_VER) || defined(__MSDOS__)
+# include "xgetcwd.h"
+#endif
+
+#if defined(__MINGW32__) || defined(_MSC_VER)
+/* MS docs says the maximum is 32K, but my testing indicates it fails
+   to run a subsidiary at 32760, which is slightly less.  So we play
+   it safe and leave a 50-byte slack.  We add 2K because by stupid
+   Posix rules bc_init_controlinfo will subtract 2K, and we are not
+   Posix.  PATH_MAX is subtracted to leave enough space for the file
+   name of the invoked program itself, and 2 more for the space and
+   terminating null character.  */
+# define ARG_MAX (32700 + 2048 - PATH_MAX - 2)
+#endif
 
 #ifndef LONG_MAX
 # define LONG_MAX (~(1 << (sizeof (long) * 8 - 1)))

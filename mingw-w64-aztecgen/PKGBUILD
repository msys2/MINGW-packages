# $Id$
# Contributor: Jevgeny Krasovsky <jkrasovsky@gmail.com>

_realname=aztecgen
pkgbase=mingw-w64-${_realname}
pkgname="${MINGW_PACKAGE_PREFIX}-${_realname}"
pkgver=1.0.1
pkgrel=1
pkgdesc="A simple library for encoding \"Aztec Code\" barcodes (mingw-w64)"
arch=('any')
url="http://aztecgen.sourceforge.net/"
license=("BSD")
options=('strip' 'staticlibs')
source=(https://downloads.sourceforge.net/sourceforge/${_realname}/${_realname}-${pkgver}.zip
        aztecgen-unix_slashes.patch
        aztecgen-typename_fix.patch
        aztecgen-noexcept.patch)
sha256sums=('d2a36022bde4234c90f6dd68c4708169df475675c4f8b83ae267f162a5437acb'
            'c377cb65a80cb22d78d11f247912d0d2a4578c5e449a4a137957cd2afd32d3fb'
            '71ca8d457370dfda66987e5167f88f77d14254019cd53db159e12b92d5431fa4'
            '3878ab218019dbf5404cf553e99a95162baab88205ce83e367080a21338e352b')

build() {
  cd "${srcdir}/$_realname-$pkgver"
  patch -p1 -i ${srcdir}/aztecgen-unix_slashes.patch
  patch -p1 -i ${srcdir}/aztecgen-typename_fix.patch
  patch -p1 -i ${srcdir}/aztecgen-noexcept.patch

  g++ -c src/*.cpp -Iinclude/c ${CXXFLAGS}
  ar qcs libaztec.a *.o
}

package() {
  cd "${srcdir}/$_realname-$pkgver"

  install -D -m644 -t "${pkgdir}${MINGW_PREFIX}/lib/" libaztec.a
  install -D -m644 -t "${pkgdir}${MINGW_PREFIX}/include/" include/c/aztecgen.h
}

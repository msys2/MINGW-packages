--- jsonnet-0.21.0/third_party/rapidyaml/ryml_all.hpp.orig	2025-05-07 14:28:56.000000000 +0200
+++ jsonnet-0.21.0/third_party/rapidyaml/ryml_all.hpp	2026-01-09 15:50:47.657489300 +0100
@@ -7670,11 +7670,11 @@
 fastfloat_really_inline value128 full_multiplication(uint64_t a,
                                                      uint64_t b) {
   value128 answer;
-#ifdef _M_ARM64
+#if defined(_M_ARM64) && !defined(__GNUC__)
   // ARM64 has native support for 64-bit multiplications, no need to emulate
   answer.high = __umulh(a, b);
   answer.low = a * b;
-#elif defined(FASTFLOAT_32BIT) || (defined(_WIN64) && !defined(__clang__))
+#elif defined(FASTFLOAT_32BIT) || (defined(_WIN64) && !defined(__clang__) && defined(_MSC_VER))
   answer.low = _umul128(a, b, &answer.high); // _umul128 not available on ARM64
 #elif defined(FASTFLOAT_64BIT)
   __uint128_t r = ((__uint128_t)a) * b;
@@ -18140,6 +18140,10 @@
 #    undef _c4_ARM_
 #    undef _ARM_
 #endif
+#ifdef _c4_ARM64_
+#    undef _c4_ARM64_
+#    undef _ARM64_
+#endif
 
 #ifdef _c4_NOMINMAX
 #    undef _c4_NOMINMAX

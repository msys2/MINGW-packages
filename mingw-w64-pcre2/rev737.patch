--- code/trunk/src/pcre2grep.c	2017/04/07 11:06:56	736
+++ code/trunk/src/pcre2grep.c	2017/04/08 15:21:39	737
@@ -630,11 +630,24 @@
 
 #ifdef WIN32
 
+#ifndef STRICT
+# define STRICT
+#endif
+#ifndef WIN32_LEAN_AND_MEAN
+# define WIN32_LEAN_AND_MEAN
+#endif
+
+#include <windows.h>
+
 #define iswild(name) (strpbrk(name, "*?") != NULL)
 
 /* Convert ANSI BGR format to RGB used by Windows */
 #define BGR_RGB(x) ((x & 1 ? 4 : 0) | (x & 2) | (x & 4 ? 1 : 0))
 
+static HANDLE hstdout;
+static CONSOLE_SCREEN_BUFFER_INFO csbi;
+static WORD match_colour;
+
 static WORD
 decode_ANSI_colour(const char *cs)
 {
@@ -817,15 +830,6 @@
 
 #elif defined WIN32
 
-#ifndef STRICT
-# define STRICT
-#endif
-#ifndef WIN32_LEAN_AND_MEAN
-# define WIN32_LEAN_AND_MEAN
-#endif
-
-#include <windows.h>
-
 #ifndef INVALID_FILE_ATTRIBUTES
 #define INVALID_FILE_ATTRIBUTES 0xFFFFFFFF
 #endif
@@ -940,10 +944,6 @@
 
 /************* Print optionally coloured match in Windows **********/
 
-static HANDLE hstdout;
-static CONSOLE_SCREEN_BUFFER_INFO csbi;
-static WORD match_colour;
-
 static void
 print_match(const void *buf, int length)
 {

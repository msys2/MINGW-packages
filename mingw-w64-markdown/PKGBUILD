_realname=markdown
pkgbase=mingw-w64-${_realname}
pkgname=${MINGW_PACKAGE_PREFIX}-${_realname}
pkgver=24.0.0
pkgrel=1

pkgdesc="A Markdown parser for Ada (mingw-w64)"
arch=('any')
mingw_arch=('mingw32' 'mingw64' 'ucrt64')
msys2_references=(
  'aur: markdown'
  'gentoo: dev-ada/markdown'
)

url="https://github.com/AdaCore/markdown"
license=('spdx:Apache-2.0 WITH LLVM-exception')
makedepends=("${MINGW_PACKAGE_PREFIX}-gprbuild")
depends=("${MINGW_PACKAGE_PREFIX}-libvss")
source=("https://github.com/AdaCore/markdown/archive/v${pkgver}/${_realname}-${pkgver}.tar.gz")
sha256sums=('8729d896f096a85c04c74c42e29ff15fffc5684d1042572468acc31f98c14479')

build() {
  cd "${srcdir}/${_realname}-${pkgver}/"
  make BUILD_MODE=prod
}

package() {
  cd "${srcdir}/${_realname}-${pkgver}/"
  make BUILD_MODE=prod DESTDIR="${pkgdir}" PREFIX="${MINGW_PREFIX}" install

  # Copy License Files
  install -Dm644 -t "${pkgdir}${MINGW_PREFIX}/share/licenses/${_realname}" \
    "${srcdir}/${_realname}-${pkgver}"/LICENSE*
}

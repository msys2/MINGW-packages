# Maintainer: Matheus Catarino <matheus-catarino@hotmail.com>

_realname=neovim
pkgbase=mingw-w64-${_realname}
pkgname=("${MINGW_PACKAGE_PREFIX}-${_realname}")
pkgver=0.4.3
pkgrel=1
pkgdesc='Vim-fork focused on extensibility and usability (mingw-w64)'
url='https://${_realname}.io'
arch=('any')
license=('Apache')
makedepends=("${MINGW_PACKAGE_PREFIX}-gcc" "${MINGW_PACKAGE_PREFIX}-cmake" "${MINGW_PACKAGE_PREFIX}-ninja" "${MINGW_PACKAGE_PREFIX}-gperf" "${MINGW_PACKAGE_PREFIX}-libiconv"
              "${MINGW_PACKAGE_PREFIX}-libuv" "${MINGW_PACKAGE_PREFIX}-luajit" "${MINGW_PACKAGE_PREFIX}-msgpack-c" "${MINGW_PACKAGE_PREFIX}-unibilium"
              "${MINGW_PACKAGE_PREFIX}-qt5" "${MINGW_PACKAGE_PREFIX}-lua-mpack" "${MINGW_PACKAGE_PREFIX}-lua-lpeg" "${MINGW_PACKAGE_PREFIX}-gettext")
source=("${_realname}-${pkgver}.tar.gz::https://github.com/${_realname}/${_realname}/archive/v${pkgver}.tar.gz")
sha256sums=('91a0b5d32204a821bf414690e6b48cf69224d1961d37158c2b383f6a6cf854d2')

build() {
  cd ${srcdir}/${_realname}-${pkgver}
  
  MSYS2_ARG_CONV_EXCL="-DCMAKE_INSTALL_PREFIX=" \
  ${MINGW_PREFIX}/bin/cmake \
  -DCMAKE_BUILD_TYPE=Release \
  -DCMAKE_INSTALL_PREFIX=${MINGW_PREFIX} \
  -G"Ninja" \
  -B "${_builddir}-${MINGW_CHOST}"
  
  cmake --build "${_builddir}-${MINGW_CHOST}"
}
package() {
  cd ${srcdir}/${_realname}-${pkgver}
  cmake --install "${_builddir}-${MINGW_CHOST}" --prefix "${pkgdir}"
}
